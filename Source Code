import discord
from discord.ext import commands

intents = discord.Intents.default()
intents.message_content = True

bot = commands.Bot(command_prefix='t!', intents=intents)

# LÆ°u tráº¡ng thÃ¡i cháº¥m cÃ´ng cá»§a ngÆ°á»i dÃ¹ng
diemdanh_data = {}
# KÃªnh mÃ  bot sáº½ hoáº¡t Ä‘á»™ng
active_channel = None
# Emoji máº·c Ä‘á»‹nh
default_emoji = 'ğŸ“Œ'

@bot.event
async def on_ready():
    print(f'Bot Ä‘Ã£ Ä‘Äƒng nháº­p vá»›i tÃªn: {bot.user.name}')

@bot.command()
async def diemdanh(ctx):
    global active_channel
    if active_channel is None or active_channel != ctx.channel:
        await ctx.send("Vui lÃ²ng cÃ i Ä‘áº·t kÃªnh hoáº¡t Ä‘á»™ng trÆ°á»›c báº±ng lá»‡nh setchannel.")
        return
    
    user_id = str(ctx.author.id)
    emoji = diemdanh_data.get(user_id, default_emoji)
    await ctx.message.add_reaction(emoji)
    diemdanh_data[user_id] = emoji

@bot.command()
async def checkdiemdanh(ctx):
    user_id = str(ctx.author.id)
    if user_id in diemdanh_data:
        count = list(diemdanh_data.values()).count(diemdanh_data[user_id])
        await ctx.send(f"Báº¡n Ä‘Ã£ cháº¥m cÃ´ng {count} láº§n.")
    else:
        await ctx.send("Báº¡n chÆ°a cháº¥m cÃ´ng láº§n nÃ o.")

@bot.command()
async def setchannel(ctx, channel: discord.TextChannel):
    global active_channel
    active_channel = channel
    await ctx.send(f"Bot sáº½ hoáº¡t Ä‘á»™ng trong kÃªnh {channel.mention}.")

@bot.command()
async def emo(ctx, emoji: str):
    diemdanh_data[str(ctx.author.id)] = emoji
    await ctx.send(f"Emoji cháº¥m cÃ´ng cá»§a báº¡n Ä‘Ã£ Ä‘Æ°á»£c Ä‘á»•i thÃ nh {emoji}.")

# Khi cháº¡y bot, báº¡n cáº§n Ä‘áº·t token cá»§a bot cá»§a báº¡n á»Ÿ Ä‘Ã¢y
bot.run('YOUR_BOT_TOKEN')
